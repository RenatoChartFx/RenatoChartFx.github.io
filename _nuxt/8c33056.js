(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{759:function(t,e,r){var content=r(847);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,r(28).default)("ccfa7be4",content,!0,{sourceMap:!1})},845:function(t,e,r){t.exports=r.p+"img/avatarplaceholder.b11e05d.png"},846:function(t,e,r){"use strict";r(759)},847:function(t,e,r){var n=r(27)(!1);n.push([t.i,".artist-link[data-v-88dc9034]{cursor:pointer}.artist-link[data-v-88dc9034]:hover{background-color:rgba(236,238,237,.5)}.artist-link:hover .delete-btn[data-v-88dc9034]{opacity:1}.artist-link.selected[data-v-88dc9034]{background-color:#2ec4b6;color:#fff;font-weight:700}.artist-link .artist-avatar[data-v-88dc9034]{width:45px;height:45px}.artist-selection .artist-avatar[data-v-88dc9034]{width:120px;height:120px}.modal-body[data-v-88dc9034]{min-height:300px}",""]),t.exports=n},923:function(t,e,r){"use strict";r.r(e);r(41),r(32),r(55),r(56);var n=r(0),c=r(18),o=(r(15),r(138),r(11),r(23),r(31),r(87),r(54),r(59),r(64),r(188),r(73),r(65),r(185),r(34));function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(c.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var h={name:"AddArtistModal",props:{},data:function(){return{view:"artistSelector",chooseArtistMode:"search",artistSelectionError:null,artistURLError:null,artistBannedError:null,artistSearchTerm:"",artistContactEmail:"",searchTerm:"",artistURL:"",searchedArtists:[],artistSearchPlaceholder:"Start by typing your artist name above",artistURLPlaceholder:"Enter your Artist Spotify URL above",isLoading:!1,searchTimeout:"",selectedSearchedArtist:null,selectedArtistGenres:[],spotifyArtistGenres:[],artistIdToSelect:null}},computed:d(d(d(d({},Object(o.c)("app",["mainGenres","showModal"])),Object(o.c)("artist",["matchingPlaylisters","accountArtists","accountArtistSelection"])),Object(o.c)("user",["user"])),{},{musicGenres:function(){return this.mainGenres},isLabel:function(){return"label"===this.user.UserType},isArtistEmailNotifyValid:function(){return!this.isLabel||(""===this.artistContactEmail.trim()||this.isEmailValid(this.artistContactEmail.trim()))},hasSelectedArtistBeenAdded:function(){var t=!1,e=this;return e.accountArtists.length>0&&e.accountArtists.forEach((function(r){r.SpotifyArtistId===e.selectedSearchedArtist.Id&&(t=!0)})),t},artistOnboarding:function(){return!(!this.user||("artist"!==this.user.UserType||null!==this.user.SpotifyArtistId)&&("label"!==this.user.UserType||this.accountArtists&&0!==this.accountArtists.length))}}),watch:{view:function(){this.artistBannedError=null},accountArtists:function(){var t=this;if(t.artistIdToSelect&&t.accountArtists.length>0){var e=t.accountArtists.filter((function(e){return e.Id===t.artistIdToSelect}));e.length>0&&(t.setAccountArtistSelection(e[0]),t.artistIdToSelect=null,t.onCloseAddArtistModal())}}},methods:d(d(d({},Object(o.b)("app",["showModalWindow"])),Object(o.b)("artist",["setAccountArtistSelection","loadAccountArtists"])),{},{changeSearchMode:function(t){this.searchedArtists=[],this.selectedSearchedArtist=null,this.chooseArtistMode=t,this.checkToSearch()},backToSearchActive:function(){this.view="artistSelector"},checkToSearch:function(){var t=this;clearTimeout(t.searchTimeout),t.searchTimeout=setTimeout((function(){if("url"===t.chooseArtistMode)""!=t.artistURL.trim()&&t.searchForArtistURL();else""!=t.artistSearchTerm.trim()&&t.searchForArtist()}),400)},getAvatarImage:function(image){return"null"!=image&&null!=image&&""!=image&&void 0!==image?image:r(845)},searchForArtist:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t).artistSearchTerm.includes("https://open.spotify.com/artist/")&&(r.artistURL=r.artistSearchTerm,r.searchForArtistURL()),r.searchedArtists=[],e.next=5,t.$api.artist.searchArtist(r.artistSearchTerm.trim());case 5:(n=e.sent)&&(r.searchedArtists=n,r.selectedSearchedArtist=n[0]),r.searchedArtists.length>0?r.artistSearchPlaceholder="Start by typing your artist name above":r.artistSearchPlaceholder="No artists found under that name. Please try again.";case 8:case"end":return e.stop()}}),e)})))()},searchForArtistURL:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,c,o,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=t).searchedArtists=[],r.selectedSearchedArtist=null,r.artistURLPlaceholder="",n=r.parseSearch(r.artistURL),c=n.Value,o={SpotifyArtistId:c},e.t0=n.Type,e.next="artistURL"===e.t0?10:29;break;case 10:if(""==c){e.next=26;break}return e.prev=11,e.next=14,t.$api.artist.artistDetails(o.SpotifyArtistId);case 14:(l=e.sent).Id=c,r.searchedArtists=[l],r.selectedSearchedArtist=r.searchedArtists[0],e.next=24;break;case 20:e.prev=20,e.t1=e.catch(11),r.searchedArtists=[],r.artistURLPlaceholder="Invalid Spotify Artist URL. Please try again.";case 24:e.next=28;break;case 26:r.searchedArtists=[],r.artistURLPlaceholder="Invalid Spotify Artist URL. Please try again.";case 28:return e.abrupt("break",31);case 29:return r.artistURLPlaceholder="Invalid Spotify Artist URL. Please try again.",e.abrupt("break",31);case 31:case"end":return e.stop()}}),e,null,[[11,20]])})))()},parseSearch:function(t){var e={},r=null,n=null;if(t.trim().includes("open.spotify.com/")){try{var c=t.trim();r=(c=c.slice(c.indexOf("open.spotify.com/")+17,c.length)).slice(0,c.indexOf("/")),(n=c.slice(c.indexOf("/")+1,c.length)).includes("?")&&(n=n.slice(0,n.indexOf("?")))}catch(t){console.warn(t)}e.Type="".concat(r,"URL"),e.Value=n}else e.Type="term",e.Value=this.searchTerm.trim();return e},onSelectArtist:function(t){var e=this;e.selectedSearchedArtist=null,e.artistSelectionError=null,e.selectedSearchedArtist=t},onCloseAddArtistModal:function(){this.artistIdToSelect||(this.view="artistSelector",this.chooseArtistMode="search",this.artistSelectionError=null,this.artistURLError=null,this.artistSearchTerm="",this.searchTerm="",this.artistURL="",this.searchedArtists=[],this.artistSearchPlaceholder="Start by typing your artist name above",this.artistURLPlaceholder="Enter your Artist Spotify URL above",this.searchTimeout="",this.selectedSearchedArtist=null,this.selectedArtistGenres=[],this.spotifyArtistGenres=[],this.showModalWindow(""))},SelectAccountArtistById:function(t){var e=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return e.artistIdToSelect=t,r.next=3,e.loadAccountArtists();case 3:case"end":return r.stop()}}),r)})))()},getSelectedArtistGenres:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=t).hasSelectedArtistBeenAdded){e.next=5;break}"search"===r.chooseArtistMode?r.artistSelectionError="Oops. You've already added this artist.":r.artistURLError="Oops. You've already added this artist.",e.next=17;break;case 5:return r.selectedArtistGenres=[],r.spotifyArtistGenres=[],e.next=9,t.$api.artist.artistGenresById(r.selectedSearchedArtist.Id);case 9:if(!((n=e.sent).length>0)){e.next=16;break}return n.forEach((function(t){r.spotifyArtistGenres.push(t.Genre)})),e.next=14,t.$api.artist.convertSubGenres(r.spotifyArtistGenres);case 14:(c=e.sent).length>0&&c.forEach((function(t){r.selectedArtistGenres.push(t.MainGenre)}));case 16:r.view="genreSelector";case 17:case"end":return e.stop()}}),e)})))()},genrePillStyle:function(t){return this.selectedArtistGenres.length>0&&this.selectedArtistGenres.includes(t)?" active bg-primary fw-bold":"bg-light fw-normal"},selectArtistGenre:function(t){this.selectedArtistGenres.length>0&&this.selectedArtistGenres.includes(t)?(this.selectedArtistGenres.splice(this.selectedArtistGenres.indexOf(t),1),0==this.selectedArtistGenres.length&&(this.selectedArtistGenres=[])):this.selectedArtistGenres.push(t)},submitArtistUpdate:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){var r,n,c,o,l,d,h,m,v,f,A;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t).artistBannedError=null,!r.selectedSearchedArtist.Id||""==r.selectedSearchedArtist.Id){e.next=57;break}return e.prev=3,e.next=6,t.$api.artist.checkArtistBan(r.selectedSearchedArtist.Id);case 6:if(n=e.sent,console.log(n),!(n.length>0)){e.next=12;break}return r.artistBannedError='The artist you have selected cannot be promoted. Please go back and select another artist. For further questions, <a href="mailto:info@playlister.club">contact us.</a>',r.isLoading=!1,e.abrupt("return");case 12:if(!(r.selectedArtistGenres.length>0&&void 0!==r.selectedSearchedArtist)){e.next=49;break}r.isLoading=!0,t.onRegisterPixelEvents(r.selectedArtistGenres.toString()),c=r.spotifyArtistGenres.map((function(t){return t.trim()})),r.spotifyArtistGenres=c,o=r.selectedArtistGenres.map((function(t){return t.trim()})),r.selectedArtistGenres=o,0==(l=r.spotifyArtistGenres.toString()).length&&(l="none"),null!=(d=r.selectedSearchedArtist.Followers)&&void 0!==d||(d=0),null!=(h=r.selectedSearchedArtist.Image)&&void 0!==h&&""!=h||(h="null"),e.t0=r.user.UserType,e.next="artist"===e.t0?28:"label"===e.t0?38:48;break;case 28:return m={spotifyid:r.selectedSearchedArtist.Id,artistname:r.selectedSearchedArtist.Name,spotifygenres:l,maingenres:r.selectedArtistGenres.toString(),imageurl:h,followers:d},e.next=31,t.$api.user.updateOnboardingData(m);case 31:return e.sent,e.next=34,t.$api.user.deleteUserPromotions;case 34:return e.sent,sessionStorage.removeItem("current_user"),t.updateGlobalLoggedInUser().then((function(t){r.onCloseAddArtistModal()})),e.abrupt("break",49);case 38:return v="",l.length>0&&(v+="".concat(l,",")),v+=r.selectedArtistGenres.toString(),""===(f=t.artistContactEmail).trim()&&(f="null"),e.next=45,t.$api.artist.insertLabelArtist({spotifyid:r.selectedSearchedArtist.Id,name:r.selectedSearchedArtist.Name,followers:r.selectedSearchedArtist.Followers,image:r.selectedSearchedArtist.Image||"null",genres:v,email:f});case 45:return A=e.sent,t.updateGlobalLoggedInUser().then((function(t){A[0]&&A[0].Id&&r.SelectAccountArtistById(A[0].Id),r.onCloseAddArtistModal()})),e.abrupt("break",49);case 48:return e.abrupt("break",49);case 49:e.next=55;break;case 51:e.prev=51,e.t1=e.catch(3),console.warn(e.t1),r.artistBannedError="We couldn't add the selected artist. Please try again later";case 55:e.next=59;break;case 57:r.artistBannedError='We could not process your request. Please try again or <a href="mailto:info@playlister.club">contact us.</a>',r.isLoading=!1;case 59:case"end":return e.stop()}}),e,null,[[3,51]])})))()}})},m=(r(846),r(8)),component=Object(m.a)(h,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"modal d-block backdrop",staticStyle:{"background-color":"rgba(0,0,0,0.5)"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable text-dark"},[e("div",{staticClass:"add-artist-modal modal-content w-100"},["artistSelector"===t.view?e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("div",{staticClass:"column pt-2"},[t.artistOnboarding?e("h6",[t._v("\n              Welcome!\n            ")]):t._e(),t._v(" "),e("h3",[t._v("Add Artist to Promote")]),t._v(" "),t.artistOnboarding?e("p",{staticClass:"m-0"},[t._v("\n              "+t._s(t.isLabel?"In order to continue, please add the first artist you're looking to promote":"In order to continue, please select the artist you're promoting")+"\n            ")]):t._e()])]),t._v(" "),e("div",{staticClass:"modal-body pt-2"},[e("ul",{staticClass:"nav nav-center mx-0 px-0 mb-3",attrs:{role:"tablist"}},[e("li",{staticClass:"nav-item px-2",attrs:{role:"presentation"}},[e("button",{staticClass:"nav-link border-start-0 border-end-0 border-top-0 bg-transparent text-dark px-2",class:{active:"search"==t.chooseArtistMode},on:{click:function(e){return e.stopPropagation(),t.changeSearchMode("search")}}},[t._v("\n                Search by Name\n              ")])]),t._v(" "),e("li",{staticClass:"nav-item px-0",attrs:{role:"presentation"}},[e("button",{staticClass:"nav-link border-start-0 border-end-0 border-top-0 bg-transparent text-dark px-2",class:{active:"url"==t.chooseArtistMode},on:{click:function(e){return e.stopPropagation(),t.changeSearchMode("url")}}},[t._v("\n                Enter Artist Spotify Link\n              ")])])]),t._v(" "),"search"==t.chooseArtistMode?e("div",{staticClass:"artist-search"},[e("div",{staticClass:"form-item search-input d-flex flex-row align-items-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.artistSearchTerm,expression:"artistSearchTerm"}],ref:"artistSearchTerm",staticClass:"form-control",attrs:{type:"text",placeholder:"Enter Artist Name..."},domProps:{value:t.artistSearchTerm},on:{keyup:function(e){return t.checkToSearch()},input:function(e){e.target.composing||(t.artistSearchTerm=e.target.value)}}}),t._v(" "),e("div",{staticClass:"flex-grow-0 p-2 px-3",on:{click:function(e){return e.stopPropagation(),t.checkToSearch()}}},[e("font-awesome-icon",{staticClass:"icon fs-5",attrs:{icon:["far","search"]}})],1)]),t._v(" "),t.artistSelectionError?e("div",{staticClass:"modal-error"},[e("font-awesome-icon",{staticClass:"error-icon",attrs:{icon:["fas","exclamation-circle"]}}),t._v(" "),e("span",{staticClass:"error-text"},[t._v(t._s(t.artistSelectionError))])],1):t._e(),t._v(" "),e("div",{staticClass:"artist-options"},[t.searchedArtists&&t.searchedArtists.length>0?e("div",[e("ul",{staticClass:"list-group list-group-flush"},t._l(t.searchedArtists,(function(r,n){return e("li",{key:"sartist_"+n,staticClass:"list-group-item artist-link",class:r==t.selectedSearchedArtist?"artist-item selected":"artist-item",on:{click:function(e){return e.stopPropagation(),t.onSelectArtist(r)}}},[e("div",{staticClass:"row align-items-center"},[e("div",{staticClass:"col flex-grow-0"},[e("img",{staticClass:"rounded-circle artist-avatar",attrs:{src:t.getAvatarImage(r.Image),alt:r.Name+" Photo"}})]),t._v(" "),e("div",{staticClass:"col flex-grow-1"},[t._v("\n                        "+t._s(r.Name)+"\n                      ")])])])})),0)]):e("p",{staticClass:"fst-italic text-muted p-2"},[t._v("\n                "+t._s(t.artistSearchPlaceholder)+"\n              ")])])]):t._e(),t._v(" "),"url"==t.chooseArtistMode?e("div",{staticClass:"artist-url"},[e("div",{staticClass:"form-item search-input d-flex flex-row align-items-center"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.artistURL,expression:"artistURL"}],ref:"artistURL",staticClass:"form-control",attrs:{type:"text",placeholder:"Enter Artist Spotify Link..."},domProps:{value:t.artistURL},on:{keyup:function(e){return t.checkToSearch()},input:function(e){e.target.composing||(t.artistURL=e.target.value)}}}),e("div",{staticClass:"flex-grow-0 p-2 px-3",on:{click:function(e){return e.stopPropagation(),t.checkToSearch()}}},[e("font-awesome-icon",{staticClass:"icon fs-5",attrs:{icon:["far","search"]}})],1)]),t._v(" "),t.artistURLError?e("div",{staticClass:"modal-error"},[e("font-awesome-icon",{staticClass:"error-icon",attrs:{icon:["fas","exclamation-circle"]}}),t._v(" "),e("span",{staticClass:"error-text"},[t._v(t._s(t.artistURLError))])],1):t._e(),t._v(" "),e("div",{staticClass:"artist-options"},[t.searchedArtists&&t.searchedArtists.length>0?e("div",{staticClass:"scroller"},[e("ul",{staticClass:"list-group list-group-flush"},t._l(t.searchedArtists,(function(r,n){return e("li",{key:"lartist_"+n,staticClass:"list-group-item artist-link",class:r==t.selectedSearchedArtist?"artist-item selected":"artist-item",on:{click:function(e){return e.stopPropagation(),t.onSelectArtist(r)}}},[e("div",{staticClass:"row align-items-center"},[e("div",{staticClass:"col flex-grow-0"},[e("img",{staticClass:"rounded-circle artist-avatar",attrs:{src:t.getAvatarImage(r.Image),alt:r.Name+" Photo"}})]),t._v(" "),e("div",{staticClass:"col flex-grow-1"},[t._v("\n                        "+t._s(r.Name)+"\n                      ")])])])})),0)]):e("p",{staticClass:"fst-italic text-muted p-2"},[t._v("\n                "+t._s(t.artistURLPlaceholder)+"\n              ")])])]):t._e()]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("div",{staticClass:"columns centered"},[e("button",{staticClass:"btn m-2 btn-secondary",attrs:{disabled:t.artistOnboarding},on:{click:function(e){return e.stopPropagation(),t.onCloseAddArtistModal()}}},[t._v("\n              Cancel\n            ")]),t._v(" "),e("button",{staticClass:"btn m-2 btn-primary",attrs:{disabled:t.selectedSearchedArtist?null:"disabled"},on:{click:function(e){return t.getSelectedArtistGenres()}}},[t._v("\n              Continue\n            ")])])])]):"genreSelector"===t.view?e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header"},[e("button",{directives:[{name:"show",rawName:"v-show",value:t.backToSearchActive,expression:"backToSearchActive"}],staticClass:"btn btn-transparent p-2",on:{click:function(e){t.view="artistSelector"}}},[e("font-awesome-icon",{staticClass:"fs-4",attrs:{icon:["fal","angle-left"]}})],1),t._v(" "),e("h6",{staticClass:"pt-2"},[t._v("\n            Selected Artist:\n          ")])]),t._v(" "),e("div",{staticClass:"modal-body"},[e("div",{staticClass:"intro"},[e("div",{staticClass:"artist-selection d-flex flex-row position-relative"},[e("div",{staticClass:"div-avatar flex-grow-0 pe-4"},[e("img",{staticClass:"rounded-circle artist-avatar",attrs:{src:t.getAvatarImage(t.selectedSearchedArtist.Image),alt:t.selectedSearchedArtist.Name+" Photo"}})]),t._v(" "),e("div",{staticClass:"col"},[e("h3",[t._v(t._s(t.selectedSearchedArtist.Name))]),t._v(" "),e("p",{staticClass:"m-0"},[t._v("\n                  Please select your genres below:\n                ")]),t._v(" "),e("div",{staticClass:"genre-selector py-4 pe-5"},t._l(t.musicGenres,(function(r,n){return e("span",{key:n+"_"+r,staticClass:"badge rounded-pill mx-1 px-2",class:t.genrePillStyle(r),on:{click:function(e){return t.selectArtistGenre(r)}}},[t._v(t._s(r))])})),0),t._v(" "),t.isLabel?e("div",{staticClass:"artist-contact p-2 pe-3"},[e("div",{staticClass:"column flex"},[e("label",[t._v("Artist notification (optional):")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.artistContactEmail,expression:"artistContactEmail"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Enter artist contact email..."},domProps:{value:t.artistContactEmail},on:{input:function(e){e.target.composing||(t.artistContactEmail=e.target.value)}}})]),t._v(" "),t._m(0)]):t._e(),t._v(" "),t.artistBannedError?e("div",{staticClass:"modal-error artist-ban"},[e("font-awesome-icon",{staticClass:"icon text-danger",attrs:{icon:["fas","ban"]}}),t._v(" "),e("span",{staticClass:"error-text",domProps:{innerHTML:t._s(t.artistBannedError)}})],1):t._e()])])])]),t._v(" "),e("div",{staticClass:"modal-footer"},[e("div",{staticClass:"columns centered"},[e("button",{staticClass:"btn m-2 btn-secondary",attrs:{disabled:t.artistOnboarding},on:{click:function(e){return e.stopPropagation(),t.onCloseAddArtistModal()}}},[t._v("\n              Cancel\n            ")]),t._v(" "),e("button",{staticClass:"btn m-2 btn-primary",attrs:{disabled:!t.isLoading&&t.isArtistEmailNotifyValid&&t.selectedArtistGenres&&t.selectedArtistGenres.length>0?null:"disabled"},on:{click:function(e){return e.stopPropagation(),t.submitArtistUpdate()}}},[t._v("\n              Select\n            ")])])])]):t._e()])])])}),[function(){var t=this._self._c;return t("div",{staticClass:"column py-2"},[t("p",{staticClass:"small text-muted fst-italic"},[this._v("\n                      Enter an artist contact email if you want the artist to be notified when they receive a review or placement in the platform.\n                    ")])])}],!1,null,"88dc9034",null);e.default=component.exports}}]);