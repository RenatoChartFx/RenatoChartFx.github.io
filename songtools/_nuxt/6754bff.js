(window.webpackJsonp=window.webpackJsonp||[]).push([[54,55],{567:function(t,e,n){var content=n(579);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(28).default)("15216d2c",content,!0,{sourceMap:!1})},568:function(t,e,n){"use strict";n.r(e);n(54),n(59),n(39),n(72),n(65),n(31),n(11),n(80),n(64),n(86),n(23),n(87);var o={name:"SettingsControl",props:{setting:{type:Object,default:null},onChange:{type:Function,default:function(){}}},data:function(){return{controlValue:null,updateTimer:null}},computed:{settingValue:function(){switch(this.setting.Type){case"resource":case"select":default:return this.setting.StringValue;case"checkbox":return Boolean(Number(this.setting.StringValue))}},loading:{get:function(){return this.$store.getters["app/loading"]},set:function(t){this.$store.dispatch("app/onSetLoading",t)}},selectedProductSettings:{get:function(){return this.$store.getters["app/selectedProductSettings"]},set:function(t){this.$store.dispatch("app/onSetSelectedProductSettings",t)}},resourceOptions:function(){var t=this;if("resource"==this.setting.Type){var e=this.setting.SelectionOptions.split(","),n=[];return e.forEach((function(e){if(e){var o=t.separateResourceValue(e);n.push(o)}})),n}return this.setting.SelectionOptions.split("!*!")}},watch:{controlValue:function(t,e){var n=this;null!=e&&e!=t&&("SP_IMAGE"==this.setting.NameTag&&(this.loading=!0),clearTimeout(n.updateTimer),n.updateTimer=setTimeout((function(){n.onChange()}),100))}},beforeMount:function(){this.controlValue=this.settingValue},methods:{sectionChildSettingsById:function(t){return this.selectedProductSettings?this.selectedProductSettings.filter((function(e){return e.ParentId==t})):null},separateResourceValue:function(t){var e=t;return{Label:e.slice(1,e.indexOf(":")),Value:e.slice(e.indexOf(":")+1,e.length-1)}},getResourceURLfromString:function(t){return 0===t.indexOf("{")?this.separateResourceValue(t).Value:t}}},r=(n(578),n(8)),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;return t.setting?e("div",[e("div",{staticClass:"d-flex flex-row flex-nowrap align-items-end"},["resource"==t.setting.Type?e("div",{staticClass:"w-25 me-2 ratio ratio-1x1",staticStyle:{"background-position":"center center","background-size":"cover"},style:"background-image: url("+t.getResourceURLfromString(t.controlValue)+")"}):t._e(),t._v(" "),e("div",{staticClass:"flex-grow-0"},[t.setting.Icon?[t.setting.Icon.includes("tidal")?e("img",{staticStyle:{width:"18px","margin-bottom":"6px","margin-right":"8px"},attrs:{src:"songtools/img/icons/tidal.svg",alt:""}}):e("FontAwesomeIcon",{staticClass:"text-gray-500",staticStyle:{width:"18px",height:"18px","margin-right":"8px","margin-bottom":"6px","line-height":"100%"},attrs:{icon:String(t.setting.Icon).replace(" ","").split(",")}})]:t._e()],2),t._v(" "),e("div",{staticClass:"flex-grow-1 d-flex flex-column pe-2"},["checkbox"!=t.setting.Type?[e("label",{staticClass:"form-label d-6 my-0 mt-1",class:{"fw-bold":""==t.setting.ParentId}},[t._v(t._s(t.setting.Description))])]:t._e(),t._v(" "),"label"==t.setting.Type?[e("input",{directives:[{name:"model",rawName:"v-model",value:t.controlValue,expression:"controlValue"}],staticClass:"form-control setting-label",attrs:{id:"setting_"+t.setting.Id,type:"text",disabled:"",placeholder:t.setting.Description+"..."},domProps:{value:t.controlValue},on:{input:function(e){e.target.composing||(t.controlValue=e.target.value)}}})]:"resource"==t.setting.Type?[e("select",{directives:[{name:"model",rawName:"v-model",value:t.controlValue,expression:"controlValue"}],staticClass:"setting-resource form-select",attrs:{id:"setting_"+t.setting.Id},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.controlValue=e.target.multiple?n:n[0]}}},[e("option",{attrs:{disabled:""}},[t._v("\n            Select Resource...\n          ")]),t._v(" "),t.resourceOptions.length>0?t._l(t.resourceOptions,(function(n,o){return e("option",{key:"resourceOption"+o,domProps:{value:"{"+n.Label+":"+n.Value+"}"}},[t._v("\n              "+t._s(n.Label)+"\n            ")])})):t._e()],2)]:"select"==t.setting.Type?[e("select",{directives:[{name:"model",rawName:"v-model",value:t.controlValue,expression:"controlValue"}],staticClass:"setting-resource form-select",attrs:{id:"setting_"+t.setting.Id},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.controlValue=e.target.multiple?n:n[0]}}},[t.resourceOptions.length>0?[e("option",[t._v("Select...")]),t._v(" "),t._l(t.resourceOptions,(function(n,o){return e("option",{key:"resourceOption"+o,domProps:{value:n}},[t._v("\n              "+t._s(n)+"\n            ")])}))]:t._e()],2)]:"textarea"==t.setting.Type?[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.controlValue,expression:"controlValue"}],staticClass:"form-control",attrs:{id:"setting_"+t.setting.Id,rows:"3"},domProps:{value:t.controlValue},on:{input:function(e){e.target.composing||(t.controlValue=e.target.value)}}})]:"checkbox"==t.setting.Type?[e("span",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.controlValue,expression:"controlValue"}],staticClass:"form-checkbox-input",attrs:{id:"setting_"+t.setting.Id,type:"checkbox"},domProps:{checked:Array.isArray(t.controlValue)?t._i(t.controlValue,null)>-1:t.controlValue},on:{change:function(e){var n=t.controlValue,o=e.target,r=!!o.checked;if(Array.isArray(n)){var c=t._i(n,null);o.checked?c<0&&(t.controlValue=n.concat([null])):c>-1&&(t.controlValue=n.slice(0,c).concat(n.slice(c+1)))}else t.controlValue=r}}}),t._v(" "),e("label",{staticClass:"form-label d-6 p-1 mb-0",class:{"fw-bold":""==t.setting.ParentId}},[t._v(t._s(t.setting.Description))])])]:["checkbox"===t.setting.Type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.controlValue,expression:"controlValue"}],staticClass:"form-control",attrs:{id:"setting_"+t.setting.Id,type:"checkbox"},domProps:{checked:Array.isArray(t.controlValue)?t._i(t.controlValue,null)>-1:t.controlValue},on:{change:function(e){var n=t.controlValue,o=e.target,r=!!o.checked;if(Array.isArray(n)){var c=t._i(n,null);o.checked?c<0&&(t.controlValue=n.concat([null])):c>-1&&(t.controlValue=n.slice(0,c).concat(n.slice(c+1)))}else t.controlValue=r}}}):"radio"===t.setting.Type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.controlValue,expression:"controlValue"}],staticClass:"form-control",attrs:{id:"setting_"+t.setting.Id,type:"radio"},domProps:{checked:t._q(t.controlValue,null)},on:{change:function(e){t.controlValue=null}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:t.controlValue,expression:"controlValue"}],staticClass:"form-control",attrs:{id:"setting_"+t.setting.Id,type:t.setting.Type},domProps:{value:t.controlValue},on:{input:function(e){e.target.composing||(t.controlValue=e.target.value)}}})]],2)]),t._v(" "),t.sectionChildSettingsById(t.setting.Id)&&t.sectionChildSettingsById(t.setting.Id).length>0?e("div",{staticClass:"pb-2 ps-3 section-divider pt-2 my-1",class:{collapsed:0==t.controlValue}},t._l(t.sectionChildSettingsById(t.setting.Id),(function(n,o){return e("SongtoolsSettingsControl",{key:"subsettings"+t.setting.Id+"_"+o,attrs:{setting:n,"on-change":t.onChange}})})),1):t._e()]):t._e()}),[],!1,null,"5ed64ead",null);e.default=component.exports;installComponents(component,{SongtoolsSettingsControl:n(568).default})},569:function(t,e,n){var content=n(588);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(28).default)("494ee60b",content,!0,{sourceMap:!1})},578:function(t,e,n){"use strict";n(567)},579:function(t,e,n){var o=n(27)(!1);o.push([t.i,".product-settings-panel .section-divider[data-v-5ed64ead]{border-top:1px solid rgba(0,0,0,.7)!important;border-bottom:1px solid rgba(0,0,0,.7)!important;transition:all .3s ease-out;overflow:hidden}.product-settings-panel .section-divider.collapsed[data-v-5ed64ead]{height:0;opacity:0;padding-bottom:0!important;padding-top:0!important;margin-bottom:0!important;margin-top:0!important}.product-settings-panel .section-divider .section-divider[data-v-5ed64ead]{border-bottom:none!important}.product-settings-panel .form-control[data-v-5ed64ead],.product-settings-panel .form-select[data-v-5ed64ead]{background-color:rgba(0,0,0,.3);border-color:rgba(0,0,0,.3);color:#dee2e0}.product-settings-panel .form-control[data-v-5ed64ead]:focus,.product-settings-panel .form-select[data-v-5ed64ead]:focus{background-color:rgba(0,0,0,.72);color:#f9fafa}",""]),t.exports=o},587:function(t,e,n){"use strict";n(569)},588:function(t,e,n){var o=n(27)(!1);o.push([t.i,".product-settings .form-footer[data-v-05765fa3]{background-color:#212121}",""]),t.exports=o},590:function(t,e,n){"use strict";n.r(e);n(41),n(32),n(55),n(56);var o=n(0),r=n(18),c=(n(15),n(31),n(11),n(23),n(34));function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(r.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var f={name:"ProductSettingsSidebar",data:function(){return{saveChangesEnabled:!1}},computed:d(d(d({},Object(c.c)("artist",["selectedArtist"])),Object(c.c)("app",["selectedProduct","loading"])),{},{firstLevelProductSettings:function(){return this.selectedProductSettings?this.selectedProductSettings.filter((function(t){return""===t.ParentId})):[]},selectedProductSettings:{get:function(){return this.$store.getters["app/selectedProductSettings"]},set:function(t){this.$store.dispatch("app/onSetSelectedProductSettings",t)}}}),watch:{selectedProductSettings:function(){this.updateValues()}},mounted:function(){this.updateValues(!0)},methods:d(d({},Object(c.b)("app",["onLoadSelectedProductSettings"])),{},{sectionChildSettingsById:function(t){return this.selectedProductSettings?this.selectedProductSettings.filter((function(e){return e.ParentId===t})):null},onSaveProductSettings:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t,o=t.getSettingsValues(),r="",o.forEach((function(t,e){r+=t.NameTag+":"+t.Value,e<o.length-1&&(r+="!*!")})),e.prev=4,e.next=7,t.$api.app.saveUserSettings("?userguid="+n.selectedArtist.PCGuid+"&spotifysongid="+n.$route.params.SongId+"&service="+n.selectedProduct.Service+"&settings="+r);case 7:t.onReloadSettings(),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),console.warn(e.t0);case 13:case"end":return e.stop()}}),e,null,[[4,10]])})))()},getSettingsValues:function(){var t=[];return this.selectedProductSettings&&this.selectedProductSettings.forEach((function(e){var n=$("#setting_"+e.Id).val();"checkbox"===e.Type&&(n=!0===$("#setting_"+e.Id).prop("checked")),void 0===n&&(n=""),t.push({Id:e.Id,ParentId:e.ParentId,NameTag:e.NameTag,Type:e.Type,Description:e.Description,Icon:e.Icon,Value:""!==n?n:"null",Clicks:e.Clicks,ClicksTrend:e.ClicksTrend})})),t},onReloadSettings:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.selectedProductSettings=null,e.next=3,t.onLoadSelectedProductSettings();case 3:t.updateValues(!0);case 4:case"end":return e.stop()}}),e)})))()},updateValues:function(t){var e=this.getSettingsValues();t||(this.saveChangesEnabled=!0),this.$store.dispatch("app/onSetProductSettingValues",e)}})},m=(n(587),n(8)),component=Object(m.a)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex flex-column flex-nowrap position-absolute bottom-0 start-0 end-0 product-settings",staticStyle:{top:"40px"}},[e("div",{staticClass:"flex-grow-1 w-100 position-relative"},[e("div",{staticClass:"position-absolute top-0 bottom-0 start-0 end-0 scroller p-3 pt-0"},[t.firstLevelProductSettings?e("section",{staticClass:"product-settings-panel"},t._l(t.firstLevelProductSettings,(function(n){return e("div",{key:"setting"+n.Id,ref:"setting"+n.Id,refInFor:!0,staticClass:"setting-item mb-3"},[e("SongtoolsSettingsControl",{attrs:{setting:n,"on-change":t.updateValues}})],1)})),0):t.loading?e("section",{staticClass:"product-settings-panel d-flex flex-column align-items-center pt-4 fs-4 text-gray-600"},[e("FontAwesomeIcon",{staticClass:"loading-icon fa-spin",attrs:{icon:["fas","compact-disc"]}})],1):t._e()])]),t._v(" "),e("div",{staticClass:"flex-grow-0 w-100"},[e("div",{staticClass:"form-footer pb-3"},[e("div",{staticClass:"d-flex flex-row justify-content-center pt-3 mt-2"},[e("button",{staticClass:"btn link text-gray-500",attrs:{type:"button"},on:{click:function(e){return e.stopPropagation(),t.onReloadSettings()}}},[t._v("\n          Cancel\n        ")]),t._v(" "),e("button",{staticClass:"btn btn-primary btn-small btn-rounded",attrs:{type:"button",disabled:!t.saveChangesEnabled},on:{click:function(e){return e.stopPropagation(),t.onSaveProductSettings()}}},[t._v("\n          Save Changes\n        ")])])])])])}),[],!1,null,"05765fa3",null);e.default=component.exports;installComponents(component,{SongtoolsSettingsControl:n(568).default})}}]);